x =   [0.032889520335286
    -0.676605239119772
    1.038542812722085
    3.031126147153306
    4.031786027333133
    -1.000000000004078
    -0.999999999992397
    -1.000000000002592
    -0.999999999998093
    -0.999999999904071
    4.973487890554438
    4.894828717427431
    4.842787034707146
    4.878615652241241
    4.684684237661907
    0.298491757353279
    0.282386834922685
    0.270876994509161
    0.278872082781858
    0.232096378281100
    -0.483939271583217
    -0.463600113191995
    -0.450860100878187
    -0.459567588317286
    -0.416040142209810
    1.003396000773375
    1.002766727467674
    1.002471818865216
    1.002664420324511
    1.002176907073105];

% x = [0.657444978346484
%   -0.145157547234687
%    0.726614298085769
%    0.376491835624796
%    0.887459971455690
%   -0.999999999986840
%   -1.000000000067408
%   -0.999999997653361
%   -1.000000003283414
%   -1.000000000020785
%    0.506335684912353
%    0.165564322195586
%    0.092017687771394
%    1.491439601218078
%    0.578031515614958
%    0.339678202688404
%    0.373105184098064
%    0.384817874244666
%    0.444004952977056
%    0.337246372730158
%   -0.078359363482832
%    0.021128374568300
%    0.040449989881054
%   -0.365873059827921
%   -0.100678143708230
%    0.785455325659273
%    0.746610103308144
%    0.737762803446283
%    0.847560792798355
%    0.792904917714534];

cx    = x(1);
cy    = x(2);
cz    = x(3);
theta = x(4);
phi   = x(5);
tl   = x(6:10);
tc    = x(11:15);
px     = x(16:20);
py     = x(21:25);
pz     = x(26:30);

n = cross([px(1), py(1), pz(1)]-[px(2),py(2),pz(2)],[px(1),py(1),pz(1)]-[px(3),py(3),pz(3)]);

plot3(cx, cy, cz, '*r')
hold on;
plot3(px(1),py(1),pz(1),'*b')
plot3(px(2),py(2),pz(2),'*b')
plot3(px(3),py(3),pz(3),'*b')
plot3(px(4),py(4),pz(4),'*b')
plot3(px(5),py(5),pz(5),'*b')
plotCircle3D([cx,cy,cz],n,.33)
xlabel('x')
ylabel('y')
zlabel('z')
axis([-1 1 -1 1 0 2])
grid on

d1 = sqrt((cx-px(1))^2+(cy-py(1))^2+(cz-pz(1))^2)
d2 = sqrt((cx-px(2))^2+(cy-py(2))^2+(cz-pz(2))^2)
d3 = sqrt((cx-px(3))^2+(cy-py(3))^2+(cz-pz(3))^2)
d4 = sqrt((cx-px(4))^2+(cy-py(4))^2+(cz-pz(4))^2)
d5 = sqrt((cx-px(5))^2+(cy-py(5))^2+(cz-pz(5))^2)